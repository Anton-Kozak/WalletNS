<ns-action-bar [pageTitle]="'User Statistics'"></ns-action-bar>
<ScrollView>
    <StackLayout class="background">
        <StackLayout [visibility]="!isLoading && amountOfMoneySpent > 0 ? 'visible' : 'collapse'">
            <StackLayout class="card-stats anim-delay" shadow="25">
                <StackLayout class="card-body">
                    <GridLayout columns="3*, 7*" rows="auto" class="card-row">
                        <StackLayout col="0" row="0" class="card-icon">
                            <Label class="far icon-text" color="#972600" text="&#xf080;"></Label>
                        </StackLayout>
                        <StackLayout col="1" row="0" class="card-text">
                            <StackLayout class="card-title">
                                <Label color="#972600" textWarp="true" text="Most Used In"></Label>
                            </StackLayout>
                            <StackLayout class="card-description">
                                <Label [text]="mostUsedCategory"></Label>
                            </StackLayout>
                        </StackLayout>
                    </GridLayout>
                </StackLayout>
                <FlexboxLayout class="card-footer">
                    <Label class="fas footer-icon" color="#972600" text="&#xf885;"></Label>
                    <Label class="footer-text" text="Number of expenses"></Label>
                </FlexboxLayout>
            </StackLayout>
            <StackLayout class="card-stats anim-delay-second" shadow="25">
                <StackLayout class="card-body">
                    <GridLayout columns="3*, 7*" rows="auto" class="card-row">
                        <StackLayout col="0" row="0" class="card-icon">
                            <Label class="fas icon-text" color="#B65509" text="&#xf161;"></Label>
                        </StackLayout>
                        <StackLayout col="1" row="0" class="card-text">
                            <StackLayout class="card-title">
                                <Label color="#B65509" textWarp="true" text="Most Spent In"></Label>
                            </StackLayout>
                            <StackLayout class="card-description">
                                <Label [text]="mostSpentCategory"></Label>
                            </StackLayout>
                        </StackLayout>
                    </GridLayout>
                </StackLayout>
                <FlexboxLayout class="card-footer">
                    <Label textWrap="true" class="fas footer-icon" color="#B65509" text="&#xf885;"></Label>
                    <Label textWrap="true" class="footer-text" text="Category with the largest expenses"></Label>
                </FlexboxLayout>
            </StackLayout>
            <StackLayout class="card-stats anim-delay-third" shadow="25">
                <StackLayout class="card-body">
                    <GridLayout columns="3*, 7*" rows="auto" class="card-row">
                        <StackLayout col="0" row="0" class="card-icon">
                            <Label class="fas icon-text" color="#F38C13" text="&#xf51e;"></Label>
                        </StackLayout>
                        <StackLayout col="1" row="0" class="card-text">
                            <StackLayout class="card-title">
                                <Label fontSize="17" color="#F38C13" textWarp="true" text="Average Daily Expenses"></Label>
                            </StackLayout>
                            <StackLayout class="card-description">
                                <Label [text]="avgDailyExpenses"></Label>
                            </StackLayout>
                        </StackLayout>
                    </GridLayout>
                </StackLayout>
                <FlexboxLayout class="card-footer">
                    <Label class="fas footer-icon" color="#F38C13" text="&#xf885;"></Label>
                    <Label class="footer-text" text="Average per 1 day"></Label>
                </FlexboxLayout>
            </StackLayout>
            <StackLayout class="card-stats anim-delay-fourth" shadow="25">
                <StackLayout class="card-body">
                    <GridLayout columns="3*, 7*" rows="auto" class="card-row">
                        <StackLayout col="0" row="0" class="card-icon">
                            <Label class="fas icon-text" color="#ebcf8f" text="&#xf688;"></Label>
                        </StackLayout>
                        <StackLayout col="1" row="0" class="card-text">
                            <StackLayout class="card-title">
                                <Label text="Total Spent" color="#ebcf8f"></Label>
                            </StackLayout>
                            <StackLayout class="card-description">
                                <Label [text]="amountOfMoneySpent"></Label>
                            </StackLayout>
                        </StackLayout>
                    </GridLayout>
                </StackLayout>
                <FlexboxLayout class="card-footer">
                    <Label class="fas footer-icon" color="#ebcf8f" text="&#xf885;"></Label>
                    <Label class="footer-text" text="Total sum"></Label>
                </FlexboxLayout>
            </StackLayout>

            <StackLayout [visibility]="barExpenses !== null ? 'visible' : 'collapse'" class="card-chart anim-delay-fourth">
                <GridLayout height="600" rows="auto, *">
                    <StackLayout class="underline" row="0">
                        <Label class="card-title" text="Expenses Statistics"></Label>
                        <Label class="card-description" text="Expenses For Each Category"></Label>
                    </StackLayout>
                    <RadCartesianChart row="1">
                        <CategoricalAxis tkCartesianHorizontalAxis lineColor="#ffb204" labelFitMode="Rotate" labelSize="20"></CategoricalAxis>
                        <LinearAxis tkCartesianVerticalAxis lineColor="#ffb204" labelFitMode="Rotate" labelFormat="%.0f"></LinearAxis>
                        <BarSeries paletteMode="Item" showLabels="true" seriesName="Bar" tkCartesianSeries [items]="barExpenses" categoryProperty="Category" valueProperty="Amount">
                            <PointLabelStyle textFormat="%.0f" tkBarLabelStyle fillColor="#ffb204"></PointLabelStyle>
                        </BarSeries>
                        <Palette tkCartesianPalette seriesName="Bar">
                            <PaletteEntry tkCartesianPaletteEntry fillColor="#F4B41C" strokeWidth="3" strokeColor="#ffb204"></PaletteEntry>
                            <PaletteEntry tkCartesianPaletteEntry fillColor="#F4A719" strokeWidth="3" strokeColor="#ffb204"></PaletteEntry>
                            <PaletteEntry tkCartesianPaletteEntry fillColor="#F39916" strokeWidth="3" strokeColor="#ffb204"></PaletteEntry>
                            <PaletteEntry tkCartesianPaletteEntry fillColor="#F38C13" strokeWidth="3" strokeColor="#ffb204"></PaletteEntry>
                            <PaletteEntry tkCartesianPaletteEntry fillColor="#CB7510" strokeWidth="3" strokeColor="#ffb204"></PaletteEntry>
                            <PaletteEntry tkCartesianPaletteEntry fillColor="#C0650C" strokeWidth="3" strokeColor="#ffb204"></PaletteEntry>
                            <PaletteEntry tkCartesianPaletteEntry fillColor="#B65509" strokeWidth="3" strokeColor="#ffb204"></PaletteEntry>
                            <PaletteEntry tkCartesianPaletteEntry fillColor="#AC4606" strokeWidth="3" strokeColor="#ffb204"></PaletteEntry>
                            <PaletteEntry tkCartesianPaletteEntry fillColor="#A13603" strokeWidth="3" strokeColor="#ffb204"></PaletteEntry>
                            <PaletteEntry tkCartesianPaletteEntry fillColor="#972600" strokeWidth="3" strokeColor="#ffb204"></PaletteEntry>
                        </Palette>
                    </RadCartesianChart>
                </GridLayout>
                <FlexboxLayout class="card-footer">
                    <Label class="fas footer-icon" text="&#xf885;"></Label>
                    <Label class="footer-text" text="Some text here just for testing"></Label>
                </FlexboxLayout>
            </StackLayout>
            <StackLayout [visibility]="lastSixMonths !== null ? 'visible' : 'collapse'" class="card-chart anim-delay-fourth">
                <GridLayout height="600" rows="auto, *">
                    <StackLayout class="outer-flex underline" row="0">
                        <Label class="card-title" text="Last Six Months"></Label>
                        <Label class="card-description" text="Line Comparison"></Label>
                    </StackLayout>
                    <RadCartesianChart row="1">
                        <CategoricalAxis tkCartesianHorizontalAxis lineColor="#ffb204" ticksColor="#825B00" labelFitMode="Rotate"></CategoricalAxis>
                        <LinearAxis tkCartesianVerticalAxis lineColor="#ffb204" ticksColor="#825B00" labelFormat="%.0f"></LinearAxis>
                        <LineSeries tkCartesianSeries strokeColor="#ffb204" [items]="lastSixMonths" categoryProperty="month" valueProperty="expenseSum">
                        </LineSeries>
                    </RadCartesianChart>
                </GridLayout>
                <FlexboxLayout class="card-footer">
                    <Label class="fas footer-icon" text="&#xf885;"></Label>
                    <Label class="footer-text" text="Just text for testing"></Label>
                </FlexboxLayout>
            </StackLayout>
            <StackLayout *ngIf="expenses !== null" class="card-stats m-b-20" shadow="25">
                <StackLayout class="card-body">
                    <StackLayout class="card-chart-text">
                        <StackLayout class="card-title text-center">
                            <Label text="Your Expenses"></Label>
                        </StackLayout>
                    </StackLayout>
                    <StackLayout class="card-table">
                        <GridLayout columns="2*, 2*, 3*, 2*, 1*" rows="auto" class="row-cell-desc text-center">
                            <Label col="0" text="Title"></Label>
                            <Label textWrap="true" col="1" text="Category"></Label>
                            <Label col="2" text="Details"></Label>
                            <Label col="3" text="Date"></Label>
                            <Label col="4" text="$"></Label>
                        </GridLayout>
                        <GridLayout *ngFor="let expense of expenses; let i = index" columns="2*, 2*, 3*, 2*, 1*" rows="auto" class="row-cell-data text-center" (tap)="onExpenseTap(expense, i)">
                            <Label col="0" [text]="expense.expenseTitle" textWrap="true"></Label>
                            <Label col="1" [text]="expense.expenseCategory" textWrap="true"></Label>
                            <Label col="2" [text]="expense.expenseDescription" textWrap="true"></Label>
                            <Label col="3" [text]="expense.creationDate | date :'short'" textWrap="true"></Label>
                            <Label col="4" [text]="expense.moneySpent" textWrap="true"></Label>
                        </GridLayout>
                    </StackLayout>
                </StackLayout>
            </StackLayout>
        </StackLayout>
        <StackLayout class="card-stats text-center p-20" [visibility]="!isLoading && amountOfMoneySpent === 0 ? 'visible' : 'collapse'">
            <Label class="card-title" text="This user has not spent this month!"></Label>
        </StackLayout>
        <FlexboxLayout [visibility]="isLoading ? 'visible' : 'collapse'" class="spinner">
            <ActivityIndicator [busy]="isLoading" color="#ffb204" width="100" height="100"></ActivityIndicator>
        </FlexboxLayout>
    </StackLayout>
</ScrollView>